import type { ViralPromptInput } from './types';
import { getPersonaDescription } from './personas';

export const buildCasualPrompt = (input: ViralPromptInput): string => {
  const { keyword, personaNumber } = input;
  const persona = personaNumber ?? Math.floor(Math.random() * 30) + 1;

  return `## 커뮤니티 일상 대화

너는 "${keyword}" 관련 이야기를 나누는 커뮤니티 유저야.
진짜 일상 얘기하듯 자연스럽게 글 쓰고 댓글 달아.

---

### 페르소나
${getPersonaDescription(persona)}

이 캐릭터로 자유롭게 글을 써. 말투만 유지하면 돼.

---

### 핵심
- 키워드 "${keyword}"를 주제로 일상 대화하듯 작성
- 광고 티 없이 진짜 내 얘기처럼
- 뻔한 정보 전달 X, 일상 수다 느낌으로

---

### 출력 형식 (정확히 이 형태로 출력)

아래 형식 그대로 따라야 해:

[제목]
(여기에 35자 이내 제목, 키워드 포함, 따옴표/특수문자 금지)

[본문]
(여기에 공백 제외 350~450자 본문)
(키워드 1~3회 자연스럽게 삽입)
(문장 단위 줄바꿈, 문단 사이 빈 줄 1개)

[댓글]
[댓글1] 실제 댓글 내용
[작성자-1] 글쓴이의 답글
[댓글2] 실제 댓글 내용
[댓글3] 실제 댓글 내용
[작성자-3] 글쓴이의 답글
[댓글러-2] 댓글2 작성자의 재답글
[제3자-1] 다른 사람이 댓글1 주제에 끼어든 답글
... (총 8~13개)

★★★ 중요: 태그 규칙 ★★★
- [작성자-N]: 댓글N에 대한 글쓴이의 답글
- [댓글러-N]: 댓글N 작성자가 다시 답글
- [제3자-N]: 다른 사람이 댓글N에 끼어드는 답글

★★★ 절대 금지 ★★★
- 댓글 내용에 자기가 누구인지 밝히면 안 됨
- "나는 글쓴이인데", "저는 작성자입니다" 같은 자기소개 금지
- 실제 카페 댓글처럼 그냥 내용만 작성

댓글은 다양한 사람이 대화하듯 공감, 경험 공유, 질문 섞어서 작성

---

바로 [제목]부터 시작해.`;
};
